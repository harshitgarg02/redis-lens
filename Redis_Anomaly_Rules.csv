Rule ID,Directive(s),Category,Anomaly Description,Detection Logic,Recommended State,Severity
CLIENT-001,client-output-buffer-limit,Client Management,"The replica buffer limit is smaller than the replication backlog size, risking disconnection after a partial sync.",IF config_get('client-output-buffer-limit replica') < config_get('repl-backlog-size'),Increase the replica hard or soft limit to be larger than repl-backlog-size.,Critical
CLIENT-002,client-output-buffer-limit,Client Management,"Pub/Sub or replica client output buffers are unlimited, creating a risk of unbounded memory growth and OOM errors.",IF config_get('client-output-buffer-limit pubsub') == '0 0 0' OR config_get('client-output-buffer-limit replica') == '0 0 0',"Use default limits (e.g., 32mb 8mb 60 for pubsub) or set custom limits.",Warning
CLIENT-003,client-query-buffer-limit,Client Management,"The client query buffer is set too low for the workload, causing valid large commands or transactions to fail.",IF config_get('client-query-buffer-limit') < '10mb' AND workload_has_large_commands,Increase limit based on workload needs. Default is 1gb.,Warning
CLIENT-004,maxclients,Client Management,"The maxclients setting exceeds the operating system's file descriptor limit, preventing Redis from reaching its configured client capacity.",IF config_get('maxclients') > (os_file_descriptor_limit - 32),Increase the OS file descriptor limit or lower maxclients.,Critical
CLIENT-005,timeout,Client Management,"Client timeout is disabled, which can lead to an accumulation of idle/stale connections, consuming server resources.",IF config_get('timeout') == 0,"Set a reasonable timeout (e.g., 300 seconds) to clean up idle connections.",Warning
CLIENT-006,tcp-keepalive,Client Management,"TCP keepalive is disabled, preventing the detection of dead peers and increasing the risk of connections being dropped by firewalls.",IF config_get('tcp-keepalive') == 0,"Enable with a reasonable value, like the default of 300 seconds.",Warning
CLIENT-007,tcp-backlog,Client Management,"The TCP backlog queue is set lower than the OS limit, which can cause connection failures under high connection rates.",IF config_get('tcp-backlog') < os_get('/proc/sys/net/core/somaxconn'),Increase tcp-backlog and the OS's somaxconn value to match.,Warning
CLIENT-008,proto-max-bulk-len,Client Management,"The maximum bulk request length is set too low for an application that needs to store large values, causing client-side errors.",IF config_get('proto-max-bulk-len') < '64mb' AND app_uses_large_values,Increase to a value appropriate for the workload (default is 512mb).,Notice
LOG-001,loglevel,Logging,"Log level is set to a verbose setting in a production environment, which can degrade performance due to high I/O.",IF environment == 'production' AND (config_get('loglevel') == 'debug' OR config_get('loglevel') == 'verbose'),Set to notice or warning for production environments.,Warning
LOG-002,logfile,Logging,"Redis is configured to daemonize but the logfile is set to standard output, causing logs to be discarded to /dev/null.",IF config_get('daemonize') == 'yes' AND config_get('logfile') == '',Specify a file path for the logfile.,Warning
PROC-001,daemonize,Process Management,Daemonization is enabled when Redis is being managed by a modern supervisor like systemd or upstart.,IF config_get('daemonize') == 'yes' AND (env('UPSTART_JOB') OR env('NOTIFY_SOCKET')),Set daemonize no and use the supervised directive instead.,Warning
PROC-002,supervised,Process Management,"No supervision is configured when Redis is running under systemd or upstart, preventing it from signaling its readiness.",IF config_get('supervised') == 'no' AND (env('UPSTART_JOB') OR env('NOTIFY_SOCKET')),Set to systemd or upstart to match the supervisor.,Warning
MEM-004,replica-ignore-maxmemory / slave-ignore-maxmemory,Memory,"A replica is configured to enforce its own maxmemory limit, which can lead to data inconsistency with the primary.",IF config_get('replica-ignore-maxmemory') == 'no',"Set to yes (default) unless you have a specific, well-understood reason for replicas to evict keys independently.",Critical
MEM-005,activerehashing,Memory,"Active rehashing is disabled, which can lead to higher memory usage if the server has idle periods.",IF config_get('activerehashing') == 'no',Set to yes unless you have extremely strict latency requirements that cannot tolerate minor (2ms) delays.,Notice
MEM-006,jemalloc-bg-thread,Memory,"Jemalloc's background thread for purging memory is disabled, potentially leading to less efficient memory reclamation.",IF config_get('jemalloc-bg-thread') == 'no',Set to yes (default) for more efficient memory management.,Notice
MEM-007,tracking-table-max-keys,Memory,"The tracking table for client-side caching is unlimited, creating a risk of unbounded memory usage on the server.",IF config_get('tracking-table-max-keys') == 0,"Set to a reasonable limit (default is 1,000,000) to protect server memory.",Warning
NET-004,unixsocketperm,Network,"The Unix socket has overly permissive file permissions, allowing unauthorized local users to connect to Redis.",IF config_get('unixsocketperm') is '777' or too permissive,Set to a restrictive value like 700.,Warning
NET-005,cluster-announce-*,Network,"In a NAT or Docker environment, the cluster announcement IP/ports are not configured, which will cause cluster communication to fail.",IF is_nat_or_docker AND NOT all cluster-announce-* directives are set,"Set cluster-announce-ip, cluster-announce-port, and cluster-announce-bus-port to the externally accessible values.",Critical
SEC-003,aclfile,Security,"An external ACL file is used at the same time as requirepass or inline user definitions, which will cause Redis to fail at startup.",IF config_get('aclfile') is set AND (config_get('requirepass') is set OR any 'user' directive is in redis.conf),Use only one method for user configuration: either aclfile or inline user directives.,Critical
SEC-004,masterauth / masteruser,Security,"A replica is not configured with the primary's authentication credentials, preventing replication.",IF primary_has_auth AND (config_get('masterauth') is not set OR config_get('masteruser') is not set),Configure masterauth (for requirepass) or masteruser (for ACLs) on the replica.,Critical
PERF-001,disable-thp,Performance,"Transparent Huge Pages (THP) are not explicitly disabled, risking high latency during fork() operations for persistence or replication.",IF config_get('disable-thp') == 'no',Set to yes (default) to mitigate latency spikes.,Critical
PERF-002,io-threads,Performance,"I/O threading is enabled on a machine with fewer than 4 CPU cores, which is unlikely to provide a performance benefit.",IF config_get('io-threads') > 1 AND cpu_cores < 4,Disable I/O threads or use a machine with more cores.,Notice
PERF-003,lazyfree-lazy-*,Performance,"Lazy-freeing is disabled for a workload with large keys, which can cause the server to block when deleting, evicting, or expiring keys.",IF any lazyfree-lazy-* directive is 'no' AND workload_has_large_keys,"Set lazyfree-lazy-eviction, lazyfree-lazy-expire, and lazyfree-lazy-server-del to yes.",Warning
PERF-004,lua-time-limit,Performance,"The Lua script time limit is disabled or set excessively high, allowing a script to block the server indefinitely.",IF config_get('lua-time-limit') <= 0 OR config_get('lua-time-limit') > 10000,Set a reasonable timeout (default is 5000ms) to prevent runaway scripts.,Critical
PERF-005,gopher-enabled,Performance,"The legacy Gopher protocol is enabled, which is a potential security risk and has no modern use case.",IF config_get('gopher-enabled') == 'yes',Set to no (default).,Warning
DS-001,*-max-ziplist-* / *-compress-depth / *-max-intset-entries,Data Structures,"Internal data structure encodings are tuned far from the defaults without a deep understanding of the workload, which can negatively impact CPU and memory usage.",IF any ziplist/intset/compress directive is significantly different from default,Revert to defaults unless performance testing has proven the change is beneficial for the specific workload.,Notice
AOF-001,aof-load-truncated,Persistence,"The server is configured to abort startup on a truncated AOF file, preventing automatic recovery from a crash.",IF config_get('aof-load-truncated') == 'no',Set to yes (default) to allow Redis to load the valid portion of a truncated AOF file and start.,Warning
AOF-002,no-appendfsync-on-rewrite,Persistence,"fsync is disabled during AOF rewrites, which increases the risk of data loss if the server crashes during the rewrite process.",IF config_get('no-appendfsync-on-rewrite') == 'yes',Set to no (default) to prioritize data durability over avoiding potential latency.,Warning
RDB-001,rdbcompression,Persistence,"RDB compression is disabled, which can significantly increase the size of on-disk snapshots and backup files.",IF config_get('rdbcompression') == 'no',Set to yes (default) unless the server is extremely CPU-bound.,Notice
RDB-002,rdbchecksum,Persistence,"RDB checksums are disabled, making the snapshot file more vulnerable to undetected corruption.",IF config_get('rdbchecksum') == 'no',Set to yes (default) to enable CRC64 checksums for better data integrity.,Warning
REPL-001,min-replicas-to-write,Replication,"The mechanism to prevent writes during network partitions is disabled, increasing the risk of losing acknowledged writes.",IF config_get('min-replicas-to-write') == 0,Set to at least 1 to ensure writes are paused if a primary cannot propagate them to any replicas.,Critical
REPL-002,replica-priority / slave-priority,Replication,"A replica that should not be promoted to primary (e.g., in a different data center) has a non-zero priority.",IF replica_is_disaster_recovery_only AND config_get('replica-priority')!= 0,Set priority to 0 to prevent it from being selected in an automatic failover.,Warning
REPL-003,repl-timeout,Replication,"The replication timeout is set to a value smaller than the replica ping period, which can cause false disconnections.",IF config_get('repl-timeout') < config_get('repl-ping-replica-period'),Ensure repl-timeout is significantly larger than repl-ping-replica-period.,Critical